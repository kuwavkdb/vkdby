<div class="bg-white shadow rounded-lg p-6">
  <div class="flex items-center justify-between mb-4">
    <h3 class="text-lg font-medium leading-6 text-gray-900 dark:text-gray-100">Members</h3>
  </div>
  <div class="overflow-x-auto">
    <table class="min-w-full divide-y divide-gray-300 dark:divide-gray-700">
      <thead class="bg-gray-50 dark:bg-gray-800">
        <tr>
          <th scope="col" class="relative py-3.5 pl-4 pr-3 sm:pl-6 w-10">
            <span class="sr-only">Sort</span>
          </th>
          <th scope="col" class="px-3 py-3.5 text-left text-xs font-medium uppercase tracking-wide text-gray-500 dark:text-gray-400">Period</th>
          <th scope="col" class="px-3 py-3.5 text-left text-xs font-medium uppercase tracking-wide text-gray-500 dark:text-gray-400">Order</th>
          <th scope="col" class="px-3 py-3.5 text-left text-xs font-medium uppercase tracking-wide text-gray-500 dark:text-gray-400">Name</th>
          <th scope="col" class="px-3 py-3.5 text-left text-xs font-medium uppercase tracking-wide text-gray-500 dark:text-gray-400">Key / Old Key</th>
          <th scope="col" class="px-3 py-3.5 text-left text-xs font-medium uppercase tracking-wide text-gray-500 dark:text-gray-400">Part</th>
        </tr>
      </thead>
      <tbody class="divide-y divide-gray-200 bg-white dark:bg-gray-900 dark:divide-gray-700"
             data-controller="sortable"
             data-sortable-url-value="<%= reorder_admin_unit_unit_people_path(unit) %>">
        <% unit_people.each do |member| %>
          <tr data-id="<%= member.id %>">
            <td class="whitespace-nowrap px-3 py-4 text-sm font-medium text-gray-900 sm:pl-6 drag-handle cursor-move">
              <svg class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
              </svg>
            </td>
            <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-900 dark:text-gray-200"><%= member.period %></td>
            <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-900 dark:text-gray-200"><%= member.order_in_period %></td>
            <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-900 dark:text-gray-200">
              <% if member.person %>
                <%= link_to member.name, edit_admin_person_path(member.person), class: "text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-300" %>
              <% else %>
                <%= member.name %>
              <% end %>
            </td>
            <td class="px-3 py-4 text-sm text-gray-500 dark:text-gray-400 font-mono">
              <% if member.person %>
                <div><%= member.person.key %></div>
                <% if member.old_person_key.present? %>
                  <div class="text-xs">
                    <%= link_to member.old_person_key, "https://www.vkdb.jp/#{member.old_person_key}.html", target: "_blank", class: "text-gray-400 dark:text-gray-500 hover:text-indigo-600 dark:hover:text-indigo-400", title: "View on vkdb.jp" %>
                  </div>
                <% end %>
              <% else %>
                <% if member.person_key.present? %>
                  <div><%= link_to member.person_key, new_admin_person_path(key: member.person_key, name: member.person_name, parts: [member.part]), class: "text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-300", title: "Add new person with this key" %></div>
                <% elsif member.old_person_key.present? %>
                  <div class="text-gray-400 dark:text-gray-500"><%= member.old_person_key %></div>
                <% else %>
                  <div class="text-gray-400 dark:text-gray-500 italic">No key</div>
                <% end %>
                <% if member.old_person_key.present? && member.person_key.present? %>
                  <div class="text-xs">
                    <%= link_to member.old_person_key, "https://www.vkdb.jp/#{member.old_person_key}.html", target: "_blank", class: "text-gray-400 dark:text-gray-500 hover:text-indigo-600 dark:hover:text-indigo-400", title: "View on vkdb.jp" %>
                  </div>
                <% end %>
              <% end %>
            </td>
            <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500 dark:text-gray-400"><%= member.part.humanize %></td>
            <td class="relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6">
              <%= link_to "Edit", edit_admin_unit_unit_person_path(unit, member), class: "text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-300" %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>
